
const ColorMatrix = ({ mode }) => {
    const REDS = "1 0 0 0 0"
    const GREENS = "0 1 0 0 0"
    const BLUES = "0 0 1 0 0"
    const ALLS = ".33 .33 .33 0 0"
    const ALPHA = "0 0 0 1 0"

    const modes = [REDS, GREENS, BLUES, ALLS]
    const V = modes[mode];
    const value = [V, V, V, ALPHA].join(" ");

    return (<feColorMatrix type="matrix" values={value} in="SourceGraphic" result="colormatrix" />)
}

const Filter = ({ bg, fg, softness, children }) => {
    const hexToRGB = (hex) => {
        hex = '0x' + hex
        let r = (hex >> 16 & 0xFF) / 255
        let g = (hex >> 8 & 0xFF) / 255
        let b = (hex & 0xFF) / 255
        return [r, g, b]
    }

    const [r1, g1, b1] = hexToRGB(bg)
    const [r2, g2, b2] = hexToRGB(fg)



    return (<>
        <pattern id='pallettoni' 
            patternUnits='userSpaceOnUse' width='50' height='50' 
            patternTransform='scale(3) rotate(75)'><rect x='0' y='0' width='100%' height='100%' 
            fill={`#${bg}1f`} />
            <path d='M31.875 0c0 .885-.165 1.797-.508 2.617-.347.83-.896 1.583-1.523 2.227-.527.54-1.144 1.026-1.836 1.328-1.095.478-2.358.405-3.516.703-.754.194-1.547.323-2.226.703-.693.388-1.328.912-1.797 1.563-.756 1.214-1.03 2.15-1.094 3.476-.031 1.227-.498 2.465-.977 3.399-.466.773-1.118 1.443-1.835 1.992a6.679 6.679 0 01-1.954 1.015c-.7.232-1.462.213-2.187.352-.76.146-1.56.189-2.266.508a5.787 5.787 0 00-1.875 1.367 6.02 6.02 0 00-1.172 2.07 5.528 5.528 0 00-.195 2.344c.104.781.352 1.497.742 2.148.39.678.894 1.222 1.485 1.68.473.368 1.033.63 1.601.82.564.19 1.173.204 1.758.313.874.162 1.794.172 2.617.508.81.33 1.555.842 2.188 1.445.526.501.95 1.107 1.289 1.758.338.651.573 1.341.703 2.07.13.86.104 1.732-.078 2.617a7.252 7.252 0 01-1.055 2.383 6.78 6.78 0 01-2.031 1.914c-1.234.697-2.193.956-3.516 1.016-1.234.046-2.539.483-3.398 1.094A5.179 5.179 0 007.46 47.5c-.365.677-.56 1.51-.586 2.5H0v-6.875a6.315 6.315 0 002.305-.508 5.458 5.458 0 001.914-1.406 5.645 5.645 0 001.133-1.992 5.764 5.764 0 00.234-2.305 6.076 6.076 0 00-.664-2.187 5.666 5.666 0 00-1.524-1.72 5.648 5.648 0 00-1.601-.859C1.222 31.95 0 31.836 0 31.836V18.125c.99-.026 1.862-.247 2.617-.664a5.471 5.471 0 002.188-2.031c.547-.886.82-1.836.82-2.852a6.27 6.27 0 01.508-2.656c.338-.86.82-1.615 1.445-2.266a7.086 7.086 0 012.266-1.523c.86-.365 1.77-.344 2.656-.508.65-.12 1.333-.121 1.953-.352a5.43 5.43 0 001.719-1.015c.596-.533 1.112-1.188 1.445-1.914A5.656 5.656 0 0018.125 0m0 50c0-1.146.286-2.253.86-3.32a6.173 6.173 0 012.304-2.461 6.164 6.164 0 012.383-.977 6.33 6.33 0 012.617 0c.86.156 1.667.469 2.422.938a6.861 6.861 0 011.875 1.797c.417.572.742 1.21.977 1.914.208.677.312 1.38.312 2.109m11.25 0c0-.625-.084-1.221-.273-1.797a5.078 5.078 0 00-.82-1.562c-.493-.623-1.068-1.172-1.798-1.563a5.758 5.758 0 00-2.265-.703l-.625-.04-.625-.038a6.61 6.61 0 01-2.227-.625 7.299 7.299 0 01-1.914-1.367 6.453 6.453 0 01-1.445-2.227 6.79 6.79 0 01-.508-2.578c0-.625-.104-1.237-.312-1.836a5.595 5.595 0 00-.899-1.64c-.495-.678-1.146-1.211-1.953-1.602A5.752 5.752 0 0025 31.875a6.618 6.618 0 01-3.125-.781c-1.016-.521-1.836-1.224-2.46-2.11a6.42 6.42 0 01-1.095-2.421 7.03 7.03 0 01-.117-2.657 8.07 8.07 0 01.664-2.031 7.113 7.113 0 011.29-1.758 6.875 6.875 0 012.187-1.484c.808-.338 1.702-.484 2.578-.508a6.68 6.68 0 012.226.312c.715.232 1.402.59 1.993 1.055a7.293 7.293 0 011.757 1.992c.451.763.769 1.615.899 2.5l.078.86.04.82c.13.964.468 1.836 1.015 2.617a5.85 5.85 0 001.68 1.524c.64.381 1.373.624 2.109.742a5.397 5.397 0 001.797-.04c.583-.105 1.17-.28 1.68-.585.758-.455 1.456-1.065 1.952-1.797 1.305-2.082.736-4.545 1.914-6.602a7.282 7.282 0 011.797-2.03c.579-.452 1.25-.782 1.953-1.016L50 18.125v13.71a6.166 6.166 0 00-2.344.548 5.254 5.254 0 00-1.914 1.445 5.192 5.192 0 00-1.133 2.031 5.578 5.578 0 00-.195 2.305c.088.736.338 1.464.703 2.11a5.862 5.862 0 001.406 1.64 5.461 5.461 0 001.641.899c.586.203 1.836.312 1.836.312V50m0-43.125a6.46 6.46 0 01-2.617-.547 6.193 6.193 0 01-2.227-1.484 6.648 6.648 0 01-1.523-2.227A7.086 7.086 0 0143.125 0H50M36.29 5.703a6.769 6.769 0 012.616.04c.86.185 1.692.562 2.422 1.054a7.035 7.035 0 011.875 1.836c.487.713.809 1.544 1.016 2.383.153.621.2 1.275.156 1.914a6.129 6.129 0 01-.43 1.914c-.372.897-.879 1.77-1.562 2.46-.688.697-1.554 1.236-2.461 1.602-.762.308-1.6.469-2.422.469a6.79 6.79 0 01-2.422-.469 7.08 7.08 0 01-2.187-1.328 7.137 7.137 0 01-1.563-2.07c-.33-.655-.526-1.383-.625-2.11-.098-.722-.106-1.472.04-2.187a7.196 7.196 0 01.976-2.422c.47-.737 1.079-1.414 1.797-1.914a7.024 7.024 0 012.773-1.172M0 0h6.875c0 .885-.17 1.758-.508 2.617a6.648 6.648 0 01-1.523 2.227 6.193 6.193 0 01-2.227 1.484A6.46 6.46 0 010 6.875z' 
            strokeWidth='1' stroke='none' 
            fill={`#${fg}1f`} />
        </pattern>
        <pattern id='cerchietti' 
            patternUnits='userSpaceOnUse' width='36' height='36' 
            patternTransform='scale(4) rotate(35)'>
            <path d='M3.445 3.624a5 5 0 01-6.89 0m8.973 4.709a10 10 0 01-11.056 0m2.083 24.043a5 5 0 016.89 0m-8.973-4.709a10 10 0 0111.056 0M39.444 3.624a5 5 0 01-6.889 0m8.973 4.709a10 10 0 01-11.056 0m2.082 24.043a5 5 0 016.891 0m-8.973-4.709a10 10 0 0111.056 0m-20.082-6.043a5 5 0 01-6.891 0m0-7.247a5 5 0 016.89 0m2.083 11.956a10 10 0 01-11.056.001m0-16.666a10 10 0 0111.056-.001' 
                strokeLinecap='square' strokeWidth='2' stroke={`#${bg}1f`} fill='none' />
            <path d='M21.624-3.445a5 5 0 010 6.89m-7.247 0a5 5 0 010-6.89m11.956-2.083a10 10 0 01.001 11.056m-16.666 0a10 10 0 01-.002-11.056m11.958 38.083a5 5 0 010 6.89m-7.247 0a5 5 0 01-.001-6.89m11.956-2.083a10 10 0 01.002 11.056m-16.666 0a10 10 0 01-.002-11.056M3.624 14.555a5 5 0 010 6.891m4.71-8.974a10 10 0 01-.001 11.056m24.042-2.082a5 5 0 01.001-6.891m-4.71 8.974a10 10 0 010-11.056' 
                strokeLinecap='square' strokeWidth='2' stroke={`#${fg}3f`} fill='none' />
        </pattern>
        <pattern id='cipollotti' patternUnits='userSpaceOnUse' width='75' height='75' patternTransform='scale(3) rotate(25)'>
            <path d='M.068 14.543c-.022 0-.045.005-.068.007v7.309l.024-.003c1.151 0 1.952.85 2.152 1.85.05.1.05.2.05.35 0 .15 0 .25-.05.35-.194 1.027-1.062 1.856-2.176 1.846v5.555l.024-.001c3.153 0 5.404 2.45 5.705 5.45 0 .1.05.15.05.3 0 .1 0 .2-.05.3-.294 3.027-2.593 5.427-5.729 5.446v5.456c1.137.013 1.927.855 2.125 1.848.05.1.051.2.051.35.05.15.05.25 0 .35-.194 1.026-1.062 1.856-2.176 1.846v7.302l.024.002c.2 0 .45-.05.65-.25 4.855-4.15 10.708-6.75 16.362-9.55 4.152-2.05 9.056-4.25 12.058-8 2.101-2.65 2.502-6.2.8-9.15-2.201-3.8-6.754-6-10.457-7.95-6.403-3.3-13.208-6.05-18.712-10.75a.989.988 0 00-.657-.263zM75 14.55c-.21.016-.423.098-.626.256-4.853 4.15-10.706 6.75-16.361 9.55-4.152 2.05-9.055 4.25-12.057 8-2.102 2.65-2.503 6.2-.8 9.15 2.2 3.8 6.753 6 10.456 7.95 6.404 3.3 13.209 6.05 18.712 10.75.2.2.45.25.651.25l.025-.002v-7.299l-.025.001c-1.151-.05-2.152-1-2.152-2.2 0-1.191.988-2.183 2.177-2.197v-5.506c-.06 0-.116.005-.175.003-3.003-.15-5.455-2.7-5.455-5.7 0-3.075 2.562-5.655 5.63-5.696v-5.605h-.025c-1.151-.05-2.152-1-2.152-2.2.05-1.174 1.01-2.15 2.177-2.192zM10.031 28.856c1.151 0 1.952.85 2.152 1.85.05.1.05.2.05.35 0 .15 0 .25-.05.35-.2 1.05-1.1 1.9-2.252 1.85-1.151-.05-2.152-1-2.152-2.2.05-1.2 1.05-2.2 2.252-2.2zm54.987 0c1.151 0 1.951.85 2.151 1.85.05.1.05.2.05.35.05.15.05.25 0 .35-.2 1.05-1.1 1.9-2.251 1.85-1.151-.05-2.152-1-2.152-2.2 0-1.2 1-2.2 2.202-2.2zm-44.93 2.95c3.152 0 5.403 2.45 5.704 5.45 0 .1.05.15.05.3 0 .1 0 .2-.05.3-.3 3.1-2.703 5.55-5.954 5.45-3.003-.15-5.455-2.7-5.455-5.7 0-3.2 2.603-5.8 5.705-5.8zm34.923.05c3.153 0 5.404 2.45 5.705 5.45 0 .1.05.15.05.3-.05 0-.05.1-.05.2-.3 3.1-2.703 5.55-5.954 5.45-3.003-.15-5.455-2.7-5.455-5.7 0-3.1 2.603-5.7 5.704-5.7zm-35.017 1.957c-1.895-.006-3.759 1.218-3.759 3.693 0 4.95 7.456 4.9 7.706 0-.125-2.45-2.052-3.687-3.947-3.693zm34.905 0c-1.889-.006-3.74 1.218-3.74 3.693 0 4.95 7.405 4.9 7.705 0-.15-2.45-2.076-3.687-3.964-3.693zm20.082 0c-1.895-.006-3.759 1.218-3.759 3.693 0 2.492 1.877 3.714 3.778 3.691v-2.094a.51.51 0 01-.225-.047c-.751-.15-1.352-.8-1.302-1.6.05-.824.711-1.502 1.527-1.542v-2.1l-.02-.001zM0 33.816v2.093l.024-.003c.85 0 1.602.7 1.602 1.6 0 .8-.601 1.4-1.352 1.55-.1.05-.15.05-.25.05L0 39.105v2.091c1.872-.035 3.754-1.27 3.877-3.69-.124-2.42-2.004-3.655-3.877-3.69zm20.088 2.09c.85 0 1.602.7 1.602 1.6 0 .8-.6 1.4-1.352 1.55-.1.05-.15.05-.25.05s-.2 0-.3-.05c-.751-.15-1.352-.8-1.302-1.6.05-.8.751-1.55 1.602-1.55zm34.923 0c.85 0 1.602.7 1.602 1.6 0 .8-.601 1.4-1.352 1.55-.1.05-.15.05-.25.05s-.2 0-.3-.05c-.75-.15-1.352-.8-1.302-1.6.05-.85.751-1.55 1.602-1.55zm-44.98 5.85c1.151 0 1.952.85 2.152 1.85.05.1.05.2.05.35 0 .15 0 .25-.05.35-.2 1.05-1.1 1.9-2.252 1.85-1.151-.05-2.152-1-2.152-2.2.05-1.2 1.05-2.2 2.252-2.2zm54.987 0c1.151 0 1.951.85 2.151 1.85.05.1.05.2.05.35.05.1.05.25 0 .35-.2 1.05-1.1 1.9-2.251 1.85-1.151-.05-2.152-1-2.152-2.2 0-1.2 1-2.2 2.202-2.2z' 
                strokeWidth='1' stroke='none' fill={`#${bg}3f`} />
            <path d='M.001 0v5.512c4.371 11.933 22.38 14.948 31.371 22.394 2.252 1.85 4.002 4.05 4.753 6.75.35 1.5.45 3 .25 4.5-1.051 6.6-7.906 10.3-13.41 13.1-6.704 3.4-14.409 6.25-19.612 11.95C1.883 65.822.752 67.631 0 69.583V75h.9c.105-7.646 7.608-11.695 13.56-14.744 3.853-1.95 8.056-3.75 11.908-6-.45.4-.95.8-1.401 1.2-2.752 2.3-5.403 4.8-7.305 7.85-2.2 3.548-3.15 7.596-3.153 11.694h1.802c.05-4.348 1.151-8.446 3.753-11.994 2.152-2.95 5.054-5.3 7.856-7.6 2.651-2.2 5.353-4.5 7.304-7.35.05-.05.1-.15.15-.2-.55 2.55-1.301 5.1-2.251 7.7C30.827 61.888 29.927 68.27 29.87 75h1.9c.05-6.848 1.051-13.196 3.404-19.645.95-2.65 1.7-5.3 2.25-8 .301 1.65.752 3.3 1.252 4.95 1.3 3.9 2.851 7.7 3.602 11.75.665 3.55.966 7.251.958 10.945h1.833a69.057 68.989 0 00-.54-8.645c-.55-4.35-1.852-8.4-3.302-12.5a51.831 51.78 0 01-1.801-6.449c1.101 1.8 2.501 3.4 4.102 4.95 4.153 3.9 9.107 7 12.159 11.85 1.986 3.143 2.978 6.97 2.978 10.794h1.882c-.004-2.97-.555-5.944-1.658-8.645-2.052-5-6.006-8.499-10.058-11.899 6.805 3.85 14.91 6.7 20.064 10.9 2.252 1.85 4.004 4.05 4.754 6.75.225.964.344 1.93.35 2.894h1v-5.294c-.4-1.15-1.001-2.3-1.702-3.35-4.302-6.35-12.108-9.55-18.712-12.8-6.604-3.25-16.06-7.45-16.16-16.05.1-7.65 7.605-11.7 13.56-14.75 6.753-3.45 14.509-6.3 19.712-12.05a15.964 15.964 0 003.253-5.45c.014.043.034.084.049.128V0h-1.001c.002.535-.028 1.07-.1 1.605-1.05 6.6-7.905 10.301-13.408 13.101-3.903 2-8.106 3.75-11.958 6 3.651-3.05 7.304-6.1 9.555-10.35C59.74 7.247 60.554 3.627 60.548 0h-1.882c0 3.11-.654 6.22-1.978 8.956-2.552 5.2-7.305 8.55-11.609 12.25-2.3 2-4.302 4.2-5.802 6.6.35-1.75.8-3.5 1.401-5.25 1.351-4 2.85-7.85 3.552-12 .605-3.44.867-7 .856-10.556h-1.85a64.948 64.884 0 01-.607 8.756c-.6 4.35-2.002 8.4-3.452 12.5-.751 2.15-1.352 4.3-1.752 6.5a61.26 61.2 0 00-2.251-8.1c-2.302-6.45-3.353-12.8-3.403-19.65V0h-1.9v.056c.05 6.75.95 13.15 3.252 19.5.95 2.6 1.701 5.1 2.252 7.7-.05-.05-.1-.15-.15-.2-2.002-2.85-4.655-5.15-7.305-7.35-2.803-2.4-5.705-4.75-7.856-7.7-2.603-3.55-3.703-7.65-3.753-12V0H14.51v.006c.05 4.15.951 8.2 3.153 11.7 1.902 3.05 4.553 5.55 7.305 7.85.45.45.95.85 1.451 1.25-3.052-1.75-6.354-3.25-9.356-4.75-6.606-3.25-16.06-7.45-16.16-16.05V0z'
                strokeWidth='1' stroke='none' fill={`#${fg}1f`} />
                </pattern>
        <pattern id='waves' patternUnits='userSpaceOnUse' width='70' height='8' patternTransform='scale(2) rotate(165)'>
            <rect x='0' y='0' width='100%' height='100%' fill={`#${bg}1f`} />
            <path d='M-.02 22c8.373 0 11.938-4.695 16.32-9.662C20.785 7.258 25.728 2 35 2c9.272 0 14.215 5.258 18.7 10.338C58.082 17.305 61.647 22 70.02 22M-.02 14.002C8.353 14 11.918 9.306 16.3 4.339 20.785-.742 25.728-6 35-6 44.272-6 49.215-.742 53.7 4.339c4.382 4.967 7.947 9.661 16.32 9.664M70 6.004c-8.373-.001-11.918-4.698-16.3-9.665C49.215-8.742 44.272-14 35-14c-9.272 0-14.215 5.258-18.7 10.339C11.918 1.306 8.353 6-.02 6.002' 
            strokeWidth='3' stroke={`#${fg}1f`} fill='none' />
        </pattern>
        <pattern id='pluses' patternUnits='userSpaceOnUse' width='32' height='32' patternTransform='scale(4) rotate(115)'>
            <path d='M37.657 10.343l-4.243 4.243m-2.828 2.828l-4.243 4.243m11.314 0l-4.243-4.243m-2.828-2.828l-4.243-4.243m-20.686 0l-4.243 4.243m-2.828 2.828l-4.243 4.243m11.314 0l-4.243-4.243m-2.828-2.828l-4.243-4.243' 
                strokeLinecap='square' strokeWidth='6' stroke={`#${bg}1f`} fill='none' />
            <path d='M16-8v6m0 4v6m8-8h-6m-4 0H8m8 24v6m0 4v6m8-8h-6m-4 0H8' 
                strokeLinecap='square' strokeWidth='6' stroke={`#${fg}3f`} fill='none' />
        </pattern>
        <filter id="sporcume">
            <feTurbulence type="fractalNoise" baseFrequency=".01" numOctaves="10" />
            <feDisplacementMap in="SourceGraphic" scale="240" />
        </filter>
        <filter id="filter" x="-10%" y="-10%" width="120%" height="120%" filterUnits="objectBoundingBox" primitiveUnits="userSpaceOnUse" colorInterpolationFilters="linearRGB">
            <ColorMatrix mode={softness} />
            <feComponentTransfer in="colormatrix" result="componentTransfer">
                <feFuncR type="table" tableValues={`${r1}, ${r2}`} />
                <feFuncG type="table" tableValues={`${g1}, ${g2}`} />
                <feFuncB type="table" tableValues={`${b1}, ${b2}`} />
                <feFuncA type="table" tableValues="0 1" />
            </feComponentTransfer>
            <feBlend mode="normal" in="componentTransfer" in2="SourceGraphic" result="blend" />
        </filter>
        <filter id="pixelate" x="0%" y="0%" width="100%" height="100%">
            <feGaussianBlur stdDeviation="2" in="SourceGraphic" result="smoothed" />
            <feImage width="15" height="15" xlinkHref="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAWSURBVAgdY1ywgOEDAwKxgJhIgFQ+AP/vCNK2s+8LAAAAAElFTkSuQmCC" result="displacement-map" />
            <feTile in="displacement-map" result="pixelate-map" />
            <feDisplacementMap in="smoothed" in2="pixelate-map" xChannelSelector="R" yChannelSelector="G" scale="50" result="pre-final" />
            <feComposite operator="in" in2="SourceGraphic" />
        </filter>
        <filter id="sand" x="0%" y="0%" width="100%" height="100%" filterUnits="objectBoundingBox" colorInterpolationFilters="sRGB">
            <feTurbulence type="fractalNoise" result="f1" stitchTiles="noStitch" baseFrequency="0.6" numOctaves="1" seed="0" />
            <feColorMatrix type="matrix" values="-18 0 0 0 8     -18 0 0 0 8     -18 0 0 0 8     0 0 0 0 1" in="f1" result="f2" />
            <feColorMatrix type="luminanceToAlpha" in="f2" result="f3" />
            <feComposite in="SourceGraphic" in2="f3" result="f4" operator="in" />
            <feColorMatrix type="matrix" values="1 0 0 0 0.22      0 1 0 0 0.22      0 0 1 0 0.22      0 0 0 1 0" in="f4" result="f5" />
            <feMerge>
                <feMergeNode in="SourceGraphic" />
                <feMergeNode in="f5" />
            </feMerge>

        </filter>
        <filter id="fe1">
            <feTurbulence id="animation" type="fractalNoise" baseFrequency="0.00001 9.9999999" numOctaves="1" result="warp">
                <animate attributeName="baseFrequency" from="0.00001 9.9999" to="0.00001 0.001" dur="2s" repeatCount="indefinite" />
            </feTurbulence>
            <feOffset dx="-90" dy="-90" result="warpOffset"></feOffset>
            <feDisplacementMap xChannelSelector="R" yChannelSelector="G" scale="30" in="SourceGraphic" in2="warpOffset"></feDisplacementMap>
        </filter>
        <pattern
            id='a'
            patternUnits='userSpaceOnUse'
            width='22' height='22'
            patternTransform='scale(3) rotate(150)'>
            <rect x='0' y='0' width='100%' height='100%' fill={`rgba(${r1},${g1},${b1},.01)`} />
            <path d='M10-6V6M10 14v12M26 10H14M6 10H-6' transform='translate(1,0)' strokeLinecap='square' strokeWidth='5' stroke={`rgba(${r2},${g2},${b2},.01)`} fill='none' />
        </pattern>

    </>)
}

export default Filter